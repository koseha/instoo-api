# 인스투(Instoo) 백엔드 PRD 문서

**Product Requirements Document - Backend API**

---

## 📋 문서 정보

| 항목      | 내용                  |
| --------- | --------------------- |
| 문서 제목 | 인스투 백엔드 API PRD |
| 버전      | v1.0                  |
| 작성일    | 2025-01-04            |
| 담당자    | 백엔드 개발팀         |
| 검토자    | 프로덕트 오너         |

---

## 🎯 제품 개요

### 프로젝트 명

**인스투 (Instoo)** - 인터넷 방송인 스케줄러 투게더

### 문제 정의

**"스트리머 일정을 파악하기 어렵다"**

현재 사용자들이 겪는 문제점:

- 스트리머가 방송에서만 일정을 말해서 놓치기 쉬움
- 개인 카페 공지를 매번 찾아봐야 함
- 일정 공지 시점이 불규칙함 (주단위 vs 당일)
- 여러 커뮤니티를 돌아다니며 정보 수집 필요

### 솔루션

위키형 방식으로 누구나 편집 가능한 스트리머 일정 통합 플랫폼

### 백엔드 역할

- 안정적인 데이터 관리 및 제공
- 확장 가능한 API 아키텍처
- 스팸 방지 및 보안 시스템
- 실시간 데이터 동기화

---

## 👥 사용자 및 스테이크홀더

### 주요 사용자 (프론트엔드를 통해 백엔드 사용)

#### 1. 스트리머 팬 (Primary User)

- **특징**: 특정 스트리머들의 일정을 정기적으로 확인
- **니즈**:
  - 구독한 스트리머 일정 한눈에 보기
  - 일정 변경 시 빠른 업데이트 확인
  - 여러 스트리머 일정 통합 관리
- **백엔드 요구사항**:
  - 빠른 일정 조회 API
  - 구독 관리 시스템
  - 실시간 변경 사항 반영

#### 2. 일반 사용자 (Secondary User)

- **특징**: 가끔 스트리머 일정 확인하거나 정보 기여
- **니즈**:
  - 간편한 일정 조회
  - 쉬운 정보 기여 (일정 등록/수정)
- **백엔드 요구사항**:
  - 직관적인 API 구조
  - 간단한 인증 시스템

#### 3. 정보 기여자 (Power User)

- **특징**: 적극적으로 일정 정보를 등록/수정하는 사용자
- **니즈**:
  - 효율적인 일정 관리 도구
  - 변경 이력 추적
  - 충돌 방지 시스템
- **백엔드 요구사항**:
  - 버전 관리 시스템
  - 동시 편집 충돌 방지
  - 변경 로그 관리

### 간접 사용자

#### 4. 시스템 관리자

- **역할**: 스팸 관리, 사용자 관리, 시스템 모니터링
- **니즈**:
  - 관리자 전용 API
  - 사용자 행동 분석
  - 시스템 건강성 모니터링
- **백엔드 요구사항**:
  - 관리자 권한 시스템
  - 로깅 및 모니터링
  - 사용자 관리 API

---

## 🎯 비즈니스 목표

### 1차 목표 (MVP)

- **사용자 확보**: 월간 활성 사용자 1,000명
- **데이터 품질**: 주요 스트리머 100명 이상의 정확한 일정 정보
- **시스템 안정성**: 99.9% 업타임 달성
- **응답 성능**: API 평균 응답 시간 200ms 이하

### 2차 목표 (확장)

- **사용자 성장**: 월간 활성 사용자 10,000명
- **데이터 확장**: 스트리머 500명 이상, 일정 정보 10,000개 이상
- **기능 확장**: 알림 시스템, 통계 API, 외부 연동
- **글로벌 확장**: 다국어 지원, 해외 플랫폼 연동

---

## 📊 성공 지표 (KPI)

### 기술적 지표

- **API 성능**: 평균 응답 시간 < 200ms, 95% 요청 < 500ms
- **시스템 안정성**: 99.9% 업타임, 장애 복구 시간 < 5분
- **데이터 정확성**: 일정 정보 정확도 95% 이상
- **보안**: 보안 사고 0건, 스팸 차단율 99% 이상

### 비즈니스 지표

- **API 사용량**: 일간 API 호출 수 100,000회 이상
- **사용자 참여**: 일정 등록/수정 참여 사용자 10% 이상
- **데이터 성장**: 월간 신규 일정 등록 500개 이상
- **사용자 만족도**: API 오류율 < 1%

---

## 🔧 기능 요구사항

### 1. 인증 및 사용자 관리

#### 1.1 사용자 인증

**우선순위**: Critical (P0)

**기능 설명**:

- Google OAuth 2.0 기반 로그인
- JWT 토큰 기반 인증
- 리프레시 토큰을 통한 자동 갱신

**API 요구사항**:

```
POST /auth/v1/google/login     # OAuth URL 생성
GET  /auth/v1/google/callback  # OAuth 콜백 처리
POST /auth/v1/refresh          # 토큰 갱신
POST /auth/v1/logout           # 로그아웃
```

**비즈니스 규칙**:

- 신규 사용자 자동 계정 생성
- 기본 역할: 일반 사용자 (USER)
- 토큰 만료시간: 액세스 토큰 7일, 리프레시 토큰 30일

**성공 조건**:

- 인증 성공률 99.5% 이상
- 토큰 검증 시간 < 50ms
- 보안 취약점 0건

#### 1.2 사용자 프로필 관리

**우선순위**: High (P1)

**기능 설명**:

- 사용자 정보 조회
- 닉네임 수정
- 프로필 이미지 관리 (추후 확장)

**API 요구사항**:

```
GET   /users/me        # 내 정보 조회
PATCH /users/me        # 내 정보 수정
GET   /users/:uuid     # 사용자 조회 (관리자)
```

**비즈니스 규칙**:

- 닉네임 중복 불가
- 닉네임 길이: 2-8자
- 닉네임 허용 문자: 한글, 영문, 숫자, '.', '\_', '-'

### 2. 방송인 관리

#### 2.1 방송인 등록

**우선순위**: Critical (P0)

**기능 설명**:

- 새로운 방송인 정보 등록
- 플랫폼별 채널 URL 관리
- 중복 방지 시스템

**API 요구사항**:

```
POST /streamers           # 방송인 등록
GET  /streamers           # 방송인 목록
GET  /streamers/:uuid     # 방송인 상세
PUT  /streamers/:uuid     # 방송인 수정
```

**비즈니스 규칙**:

- 채널 URL 기반 중복 방지
- 지원 플랫폼: Twitch, YouTube, AfreecaTV
- 모든 로그인 사용자 등록 가능

**성공 조건**:

- 중복 등록 차단율 100%
- 방송인 정보 정확도 95% 이상

#### 2.2 방송인 검색

**우선순위**: High (P1)

**기능 설명**:

- 방송인 이름 기반 검색
- 플랫폼별 필터링
- 인기순/최신순 정렬

**API 요구사항**:

```
GET /streamers/search?q=검색어&platform=twitch&sort=popular
```

**성공 조건**:

- 검색 응답 시간 < 100ms
- 검색 정확도 90% 이상

### 3. 일정 관리

#### 3.1 일정 CRUD

**우선순위**: Critical (P0)

**기능 설명**:

- 일정 등록/조회/수정/삭제
- 충돌 방지 시스템 (낙관적 락)
- 변경 이력 관리

**API 요구사항**:

```
GET    /schedules              # 일정 목록 (필터링 지원)
POST   /schedules              # 일정 등록
GET    /schedules/:uuid        # 일정 상세
PUT    /schedules/:uuid        # 일정 수정
DELETE /schedules/:uuid        # 일정 삭제
```

**비즈니스 규칙**:

- 모든 로그인 사용자 편집 가능
- 동시 편집 시 충돌 방지
- 변경 시 버전 번호 증가

**성공 조건**:

- 충돌 방지 성공률 99% 이상
- 일정 조회 성능 < 200ms

#### 3.2 일정 필터링

**우선순위**: High (P1)

**기능 설명**:

- 날짜 범위 필터링
- 방송인별 필터링
- 태그별 필터링
- 이벤트 타입별 필터링

**API 요구사항**:

```
GET /schedules?start_date=2025-01-01&end_date=2025-01-31&streamers=uuid1,uuid2&tags=gaming
```

**성공 조건**:

- 복합 필터링 응답 시간 < 300ms
- 필터링 정확도 99% 이상

### 4. 이벤트 관리

#### 4.1 이벤트 생성

**우선순위**: High (P1)

**기능 설명**:

- 합방, 대회 등 이벤트 생성
- 참가자 관리 (역할별 구분)
- 이벤트 기간 설정

**API 요구사항**:

```
POST /events                    # 이벤트 생성
GET  /events                    # 이벤트 목록
GET  /events/:uuid              # 이벤트 상세
POST /events/:uuid/participants # 참가자 추가
```

**비즈니스 규칙**:

- 참가자 역할: host, participant, mc
- 이벤트 기간: 시작일 ≤ 종료일
- 이벤트 우선 표시 (개인 일정보다)

#### 4.2 이벤트 일정 통합

**우선순위**: High (P1)

**기능 설명**:

- 이벤트 참가자 자동 표시
- 중복 일정 방지
- 이벤트 칩 UI 지원

**성공 조건**:

- 이벤트-일정 연동 정확도 99% 이상
- 중복 표시 방지율 100%

### 5. 구독 관리

#### 5.1 방송인 구독

**우선순위**: High (P1)

**기능 설명**:

- 방송인 구독/구독 해제
- 구독 목록 관리
- 구독 상태 조회

**API 요구사항**:

```
GET    /follows               # 내 구독 목록
POST   /follows               # 구독 추가
DELETE /follows/:id           # 구독 해제
```

**비즈니스 규칙**:

- 사용자당 구독 제한 없음
- 구독 즉시 반영
- 구독 해제 시 관련 데이터 정리

#### 5.2 이벤트 구독

**우선순위**: Medium (P2)

**기능 설명**:

- 이벤트 구독/구독 해제
- 이벤트별 일정 조회
- 구독 상태 관리

**API 요구사항**:

```
GET    /event-follows         # 이벤트 구독 목록
POST   /event-follows         # 이벤트 구독
DELETE /event-follows/:id     # 이벤트 구독 해제
```

### 6. 태그 시스템

#### 6.1 태그 관리

**우선순위**: Medium (P2)

**기능 설명**:

- 태그 생성/조회
- 태그별 일정 분류
- 태그 색상 관리

**API 요구사항**:

```
GET  /tags                    # 태그 목록
POST /tags                    # 태그 생성
```

**비즈니스 규칙**:

- 태그 이름 중복 불가
- 기본 태그: 게임, 토크, 합방, 대회
- 사용자 커스텀 태그 지원

### 7. 관리자 기능

#### 7.1 사용자 관리

**우선순위**: Medium (P2)

**기능 설명**:

- 사용자 목록 조회
- 사용자 상태 관리 (활성/비활성)
- 사용자 역할 변경

**API 요구사항**:

```
GET   /admin/users            # 사용자 목록
PATCH /admin/users/:uuid      # 사용자 상태 변경
```

**권한 요구사항**:

- 관리자 역할(ADMIN) 필요
- 역할 기반 접근 제어

#### 7.2 스팸 관리

**우선순위**: High (P1)

**기능 설명**:

- 스팸 일정 신고 처리
- 악성 사용자 차단
- 신고 내역 관리

**API 요구사항**:

```
POST /admin/reports           # 신고 접수
GET  /admin/reports           # 신고 목록
POST /admin/reports/:id/resolve # 신고 처리
```

#### 7.3 공지사항 관리

**우선순위**: Low (P3)

**기능 설명**:

- 공지사항 작성/수정/삭제
- 공지사항 상단 고정
- 공지사항 목록 조회

**API 요구사항**:

```
GET    /announcements         # 공지사항 목록
POST   /admin/announcements   # 공지사항 작성
PUT    /admin/announcements/:uuid # 공지사항 수정
DELETE /admin/announcements/:uuid # 공지사항 삭제
```

---

## 🔒 비기능 요구사항

### 1. 성능 요구사항

#### 응답 시간

- **일정 조회**: < 200ms (평균), < 500ms (95%)
- **사용자 인증**: < 100ms (평균)
- **방송인 검색**: < 150ms (평균)
- **일정 등록/수정**: < 300ms (평균)

#### 처리량

- **동시 사용자**: 1,000명 (1차), 10,000명 (2차)
- **API 호출**: 100,000회/일 (1차), 1,000,000회/일 (2차)
- **데이터베이스**: 10,000 TPS (1차), 100,000 TPS (2차)

### 2. 보안 요구사항

#### 인증 및 권한

- JWT 토큰 기반 인증
- 역할 기반 접근 제어 (RBAC)
- API 키 관리 (외부 연동용)

#### 데이터 보호

- HTTPS 통신 필수
- 개인정보 암호화 저장
- SQL 인젝션 방지

#### 스팸 방지

- Rate Limiting: 1분 3회, 1시간 30회
- 사용자 행동 패턴 분석
- 자동 차단 시스템

### 3. 가용성 요구사항

#### 업타임

- **목표**: 99.9% (1차), 99.99% (2차)
- **최대 장애 시간**: 월 43분 (1차), 월 4.3분 (2차)
- **복구 시간**: < 5분 (장애 감지 후)

#### 백업 및 복구

- 데이터베이스 일일 백업
- 실시간 복제 (Master-Slave)
- 장애 시 자동 페일오버

### 4. 확장성 요구사항

#### 수평 확장

- 로드 밸런서 지원
- 무상태(Stateless) API 설계
- 데이터베이스 샤딩 대응

#### 수직 확장

- 메모리 사용량 최적화
- 데이터베이스 인덱스 최적화
- 캐싱 전략 적용

---

## 🛠️ 기술 제약사항

### 1. 기술 스택 제약

- **Backend Framework**: Nest.js (TypeScript)
- **Database**: PostgreSQL 14+
- **ORM**: TypeORM
- **Cache**: Redis (추후 도입)
- **Message Queue**: Bull Queue (추후 도입)

### 2. 환경 제약

- **Node.js**: 18.x 이상
- **Memory**: 4GB 이상 (운영 환경)
- **Storage**: SSD 100GB 이상
- **Network**: 1Gbps 이상

### 3. 외부 연동 제약

- **Google OAuth**: API 제한 10,000 requests/day
- **Database Connection**: 최대 100 connections
- **File Upload**: 최대 5MB (프로필 이미지)

---

## 📋 데이터 요구사항

### 1. 데이터 모델

#### 사용자 데이터

```typescript
interface User {
  id: number;
  uuid: string;
  email: string;
  nickname: string;
  profileImageUrl?: string;
  provider: "GOOGLE";
  providerId: string;
  role: "USER" | "ADMIN";
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
}
```

#### 방송인 데이터

```typescript
interface Streamer {
  id: number;
  uuid: string;
  name: string;
  description?: string;
  platforms: StreamerPlatform[];
  createdAt: Date;
  updatedAt: Date;
}

interface StreamerPlatform {
  streamerId: number;
  platformName: string;
  channelUrl: string;
}
```

#### 일정 데이터

```typescript
interface Schedule {
  id: number;
  uuid: string;
  title: string;
  startTime: Date;
  streamerId?: number;
  eventId?: number;
  tags: Tag[];
  version: number;
  createdAt: Date;
  updatedAt: Date;
}
```

### 2. 데이터 품질 요구사항

#### 정확성

- **방송인 정보**: 95% 이상 정확
- **일정 정보**: 90% 이상 정확
- **사용자 정보**: 99% 이상 정확

#### 완전성

- **필수 필드**: 100% 입력
- **선택 필드**: 70% 이상 입력
- **메타데이터**: 100% 자동 생성

#### 일관성

- **데이터 형식**: 표준 형식 준수
- **참조 무결성**: 100% 유지
- **비즈니스 규칙**: 100% 적용

---

## 🔄 API 설계 원칙

### 1. REST 원칙 준수

- **HTTP 메서드**: GET, POST, PUT, DELETE 적절히 사용
- **상태 코드**: 200, 201, 400, 401, 403, 404, 500 등 표준 사용
- **리소스 중심**: 명사 기반 URL 설계

### 2. 일관성 있는 응답 형식

```typescript
interface ApiResponse<T> {
  code: number;
  message: string | null;
  content: T | null;
}
```

### 3. 에러 처리 표준화

```typescript
interface ErrorResponse {
  code: number;
  message: string;
  content: null;
  timestamp: string;
}
```

### 4. 버전 관리

- **URL 버전**: `/api/v1/`, `/api/v2/`
- **하위 호환성**: 최소 6개월 유지
- **Deprecation**: 사전 공지 후 제거

---

## 🚀 구현 단계

### Phase 1: MVP (4주)

**목표**: 기본 기능 구현

**주요 기능**:

- ✅ 사용자 인증 (Google OAuth)
- ✅ 사용자 관리 (프로필 조회/수정)
- 🔄 방송인 관리 (CRUD)
- 🔄 일정 관리 (CRUD)
- 🔄 기본 구독 시스템

**성공 조건**:

- 모든 API 응답 시간 < 500ms
- 시스템 안정성 99% 이상
- 기본 기능 100% 동작

### Phase 2: 확장 기능 (4주)

**목표**: 고급 기능 추가

**주요 기능**:

- 이벤트 관리 시스템
- 태그 시스템
- 고급 필터링
- 충돌 방지 시스템

**성공 조건**:

- 동시 사용자 100명 처리
- 데이터 정확도 95% 이상
- 고급 기능 100% 동작

### Phase 3: 관리 기능 (2주)

**목표**: 관리자 기능 완성

**주요 기능**:

- 관리자 대시보드
- 스팸 방지 시스템
- 공지사항 관리
- 사용자 관리

**성공 조건**:

- 관리 기능 100% 동작
- 스팸 차단율 99% 이상
- 관리자 만족도 95% 이상

### Phase 4: 최적화 (4주)

**목표**: 성능 및 확장성 개선

**주요 기능**:

- 성능 최적화
- 캐싱 시스템
- 모니터링 시스템
- 알림 시스템 (추후 확장)

**성공 조건**:

- 응답 시간 50% 개선
- 동시 사용자 1,000명 처리
- 시스템 안정성 99.9% 이상

---

## 🎯 성공 메트릭

### 기술 메트릭

- **API 성능**: 평균 응답 시간 < 200ms
- **에러율**: < 1%
- **업타임**: 99.9% 이상
- **보안**: 보안 사고 0건

### 사용자 메트릭

- **사용자 수**: 1,000명 (1차), 10,000명 (2차)
- **API 사용량**: 100,000회/일 (1차), 1,000,000회/일 (2차)
- **데이터 품질**: 정확도 95% 이상
- **사용자 만족도**: NPS 70 이상

### 비즈니스 메트릭

- **데이터 성장**: 월 신규 일정 500개 이상
- **사용자 참여**: 일정 편집 참여율 10% 이상
- **시스템 효율**: 서버 비용 월 $500 이하 (1차)
- **개발 효율**: 개발 속도 월 10 스토리 포인트 이상

---

## 🔍 위험 요소 및 대응 방안

### 1. 기술적 위험

#### 성능 병목

- **위험**: 대량 사용자 접속 시 응답 지연
- **대응**: 캐싱 시스템, 데이터베이스 최적화, 로드 밸런싱

#### 데이터 일관성

- **위험**: 동시 편집으로 인한 데이터 충돌
- **대응**: 낙관적 락, 버전 관리 시스템

#### 보안 취약점

- **위험**: 인증 우회, 데이터 누출
- **대응**: 보안 테스트, 암호화, 접근 제어

### 2. 운영 위험

#### 스팸 및 악용

- **위험**: 스팸 일정 등록, 시스템 남용
- **대응**: Rate Limiting, 사용자 행동 분석, 신고 시스템

#### 데이터 손실

- **위험**: 하드웨어 장애, 인적 오류
- **대응**: 정기 백업, 복제 시스템, 장애 복구 절차

#### 서비스 중단

- **위험**: 외부 의존성 실패 (Google OAuth 등)
- **대응**: 다중 인증 방식, 장애 대응 매뉴얼

---

## 📝 승인 및 검토

### 검토 체크리스트

- [ ] 비즈니스 요구사항 충족
- [ ] 기술적 실현 가능성 확인
- [ ] 보안 요구사항 검토
- [ ] 성능 요구사항 검토
- [ ] 예산 및 일정 검토

### 승인 서명

| 역할          | 이름 | 승인일 | 서명 |
| ------------- | ---- | ------ | ---- |
| 프로덕트 오너 |      |        |      |
| 기술 리더     |      |        |      |
| 보안 담당자   |      |        |      |
| QA 담당자     |      |        |      |

---

## 📚 참고 자료

### 외부 문서

- [Google OAuth 2.0 문서](https://developers.google.com/identity/protocols/oauth2)
- [PostgreSQL 성능 가이드](https://www.postgresql.org/docs/current/performance-tips.html)
- [Nest.js 공식 문서](https://docs.nestjs.com/)

### 내부 문서

- 인스투 프로젝트 기획서
- 인스투 UI/UX 디자인 가이드
- 인스투 인프라 아키텍처 문서

---

**문서 변경 이력**

| 버전 | 날짜       | 변경 내용                       | 작성자        |
| ---- | ---------- | ------------------------------- | ------------- |
| v1.0 | 2025-01-04 | 초기 PRD 문서 작성              | 백엔드 개발팀 |
| v1.1 | 2025-01-04 | 사용자 인증 및 관리 기능 상세화 | 백엔드 개발팀 |

---

## 🎯 최종 요약

### 핵심 가치 제안

**인스투 백엔드 API**는 스트리머 일정 관리의 중심 역할을 하며, 다음과 같은 핵심 가치를 제공합니다:

1. **신뢰성**: 99.9% 업타임으로 언제든 접근 가능한 안정적인 서비스
2. **확장성**: 사용자 증가에 따라 자동으로 확장 가능한 아키텍처
3. **보안성**: 철저한 인증과 권한 관리로 데이터 보호
4. **성능**: 빠른 응답 시간으로 우수한 사용자 경험 제공

### 주요 차별점

- **위키형 협업**: 누구나 참여할 수 있는 개방형 데이터 관리
- **실시간 동기화**: 일정 변경 사항의 즉시 반영
- **지능형 스팸 방지**: 다층 보안으로 데이터 품질 보장
- **유연한 확장**: 다양한 플랫폼과 기능으로 확장 가능

### 예상 임팩트

- **사용자**: 스트리머 일정 확인 시간 80% 단축
- **커뮤니티**: 정보 공유 활성화로 팬 커뮤니티 강화
- **스트리머**: 일정 공지 부담 감소 및 팬과의 소통 개선
- **생태계**: 스트리밍 산업의 정보 투명성 증대

---

## 🔮 향후 발전 방향

### 단기 계획 (3-6개월)

- **알림 시스템**: 웹 푸시, 이메일 알림 기능
- **통계 API**: 사용자 행동 분석 및 트렌드 제공
- **모바일 API**: 모바일 앱 지원을 위한 최적화
- **다국어 지원**: 글로벌 사용자를 위한 i18n 지원

### 중기 계획 (6-12개월)

- **AI 추천**: 개인화된 스트리머 및 일정 추천
- **소셜 기능**: 사용자 간 소통 및 커뮤니티 기능
- **외부 연동**: 트위치, 유튜브 API 연동으로 자동 일정 수집
- **고급 분석**: 실시간 대시보드 및 인사이트 제공

### 장기 계획 (1년 이상)

- **마이크로서비스**: 서비스 분리로 확장성 극대화
- **글로벌 CDN**: 전 세계 사용자 대상 서비스 확장
- **머신러닝**: 사용자 패턴 학습을 통한 서비스 개선
- **파트너십**: 스트리밍 플랫폼과의 공식 파트너십
